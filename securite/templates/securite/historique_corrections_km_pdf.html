{% extends 'base.html' %}
{% load static %}
{% block title %}Export PDF - Historique corrections kilométrage{% endblock %}
{% block content %}
<div style="font-family: Arial, sans-serif; margin: 30px;">
    <div style="display: flex; align-items: center; justify-content: center; margin-bottom: 20px;">
        <img src="{{ STATIC_URL }}images/logo_mamo.png" alt="Logo IPS-CO" style="height: 60px; margin-right: 20px;">
        <h2 style="text-align:center; margin: 0; font-size: 2rem; color: #2c3e50;">Historique des corrections de kilométrage</h2>
    </div>
    <div style="margin-bottom: 18px; font-size: 1.1rem;">
        <strong>Période :</strong> {{ date_debut|default:'...' }} au {{ date_fin|default:'...' }}<br>
        <strong>Date d’édition :</strong> {{ now|default:None|date:'d/m/Y H:i' }}
    </div>
    <table border="1" cellspacing="0" cellpadding="5" width="100%" style="border-collapse: collapse; font-size: 0.98rem;">
        <thead>
            <tr style="background:#f5f6fa; color:#2c3e50;">
                <th style="padding: 8px;">Date</th>
                <th style="padding: 8px;">Véhicule</th>
                <th style="padding: 8px;">Chauffeur</th>
                <th style="padding: 8px;">Valeur avant</th>
                <th style="padding: 8px;">Valeur après</th>
                <th style="padding: 8px;">Motif</th>
                <th style="padding: 8px;">Auteur</th>
            </tr>
        </thead>
        <tbody>
            {% for corr in corrections %}
            <tr style="background: {% cycle '#fff' '#f9fafb' %};">
                <td style="padding: 7px;">{{ corr.date_correction|date:'d/m/Y H:i' }}</td>
                <td style="padding: 7px;">{{ corr.vehicule.immatriculation }}</td>
                <td style="padding: 7px;">{% if corr.chauffeur %}{{ corr.chauffeur.get_full_name }}{% else %}<span style="color:#888;">Non renseigné</span>{% endif %}</td>
                <td style="padding: 7px;">{{ corr.valeur_avant }}</td>
                <td style="padding: 7px;">{{ corr.valeur_apres }}</td>
                <td style="padding: 7px;">{% if corr.motif %}{{ corr.motif }}{% else %}<span style="color:#888;">Aucun</span>{% endif %}</td>
                <td style="padding: 7px;">{% if corr.auteur %}{{ corr.auteur.get_full_name }}{% else %}<span style="color:#888;">Non renseigné</span>{% endif %}</td>
            </tr>
            {% empty %}
            <tr><td colspan="7" style="text-align:center; color:#888;">Aucune correction trouvée.</td></tr>
            {% endfor %}
        </tbody>
    </table>
    <div style="margin-top: 30px; text-align: right; color: #888; font-size: 0.95rem;">
        Rapport généré le {{ now|default:None|date:'d/m/Y H:i' }}
    </div>
</div>
{% endblock %} 